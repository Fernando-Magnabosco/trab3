('WindowAgg  (cost=1671419.83..1846419.83 rows=10000000 width=47) (actual time=2296.507..4217.940 rows=10000003 loops=1)',)
('  ->  Sort  (cost=1671419.83..1696419.83 rows=10000000 width=15) (actual time=2251.490..2724.808 rows=10000003 loops=1)',)
('        Sort Key: dep_id',)
('        Sort Method: external merge  Disk: 266416kB',)
('        ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=15) (actual time=73.886..488.525 rows=10000003 loops=1)',)
('Planning Time: 0.143 ms',)
('JIT:',)
('  Functions: 7',)
('  Options: Inlining true, Optimization true, Expressions true, Deforming true',)
('  Timing: Generation 0.198 ms, Inlining 33.769 ms, Optimization 23.558 ms, Emission 16.577 ms, Total 74.102 ms',)
('Execution Time: 4407.880 ms',)
('Subquery Scan on empregadosalariorank  (cost=1671419.83..1996419.83 rows=50000 width=15) (actual time=3535.621..5683.382 rows=33 loops=1)',)
('  Filter: (empregadosalariorank.salario_rank = 1)',)
('  Rows Removed by Filter: 9999970',)
('  ->  WindowAgg  (cost=1671419.83..1871419.83 rows=10000000 width=23) (actual time=3535.618..5496.417 rows=10000003 loops=1)',)
('        ->  Sort  (cost=1671419.83..1696419.83 rows=10000000 width=15) (actual time=3535.180..4068.134 rows=10000003 loops=1)',)
('              Sort Key: empregados.dep_id, empregados.salario DESC',)
('              Sort Method: external merge  Disk: 252120kB',)
('              ->  Seq Scan on empregados  (cost=0.00..166942.00 rows=10000000 width=15) (actual time=44.519..488.915 rows=10000003 loops=1)',)
('Planning Time: 0.075 ms',)
('JIT:',)
('  Functions: 8',)
('  Options: Inlining true, Optimization true, Expressions true, Deforming true',)
('  Timing: Generation 0.284 ms, Inlining 2.593 ms, Optimization 24.265 ms, Emission 17.673 ms, Total 44.815 ms',)
('Execution Time: 5700.906 ms',)
('Finalize GroupAggregate  (cost=130443.19..130451.55 rows=33 width=8) (actual time=424.336..428.048 rows=33 loops=1)',)
('  Group Key: dep_id',)
('  ->  Gather Merge  (cost=130443.19..130450.89 rows=66 width=8) (actual time=424.325..428.028 rows=99 loops=1)',)
('        Workers Planned: 2',)
('        Workers Launched: 2',)
('        ->  Sort  (cost=129443.16..129443.25 rows=33 width=8) (actual time=415.271..415.273 rows=33 loops=3)',)
('              Sort Key: dep_id',)
('              Sort Method: quicksort  Memory: 26kB',)
('              Worker 0:  Sort Method: quicksort  Memory: 26kB',)
('              Worker 1:  Sort Method: quicksort  Memory: 26kB',)
('              ->  Partial HashAggregate  (cost=129442.00..129442.33 rows=33 width=8) (actual time=415.241..415.244 rows=33 loops=3)',)
('                    Group Key: dep_id',)
('                    Batches: 1  Memory Usage: 24kB',)
('                    Worker 0:  Batches: 1  Memory Usage: 32kB',)
('                    Worker 1:  Batches: 1  Memory Usage: 32kB',)
('                    ->  Parallel Seq Scan on empregados  (cost=0.00..108608.67 rows=4166667 width=8) (actual time=0.018..142.867 rows=3333334 loops=3)',)
('Planning Time: 0.064 ms',)
('JIT:',)
('  Functions: 24',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 0.942 ms, Inlining 0.000 ms, Optimization 0.576 ms, Emission 10.316 ms, Total 11.835 ms',)
('Execution Time: 428.508 ms',)
('HashAggregate  (cost=379443.74..379444.16 rows=11 width=17) (actual time=2038.006..2038.009 rows=1 loops=1)',)
('  Group Key: d.dep_id, d.nome',)
('  Filter: (count(*) < 3)',)
('  Batches: 1  Memory Usage: 24kB',)
('  Rows Removed by Filter: 32',)
('  ->  Hash Right Join  (cost=1.74..304443.74 rows=10000000 width=17) (actual time=4.365..1158.126 rows=9697530 loops=1)',)
('        Hash Cond: (e.dep_id = d.dep_id)',)
('        ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=4) (actual time=0.028..392.921 rows=10000003 loops=1)',)
('        ->  Hash  (cost=1.33..1.33 rows=33 width=17) (actual time=4.332..4.332 rows=33 loops=1)',)
('              Buckets: 1024  Batches: 1  Memory Usage: 10kB',)
('              ->  Seq Scan on departamentos d  (cost=0.00..1.33 rows=33 width=17) (actual time=4.319..4.322 rows=33 loops=1)',)
('Planning Time: 0.183 ms',)
('JIT:',)
('  Functions: 16',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 0.448 ms, Inlining 0.000 ms, Optimization 0.236 ms, Emission 4.101 ms, Total 4.785 ms',)
('Execution Time: 2038.516 ms',)
('Nested Loop  (cost=0.45..417105.08 rows=9696626 width=7) (actual time=3.438..2154.637 rows=9696410 loops=1)',)
('  ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=15) (actual time=0.004..399.360 rows=10000003 loops=1)',)
('  ->  Memoize  (cost=0.45..0.50 rows=1 width=8) (actual time=0.000..0.000 rows=1 loops=10000003)',)
('        Cache Key: e.dep_id, e.supervisor_id',)
('        Cache Mode: binary',)
('        Hits: 9999671  Misses: 332  Evictions: 0  Overflows: 0  Memory Usage: 36kB',)
('        ->  Index Scan using unique_emp_id on empregados e2  (cost=0.43..0.49 rows=1 width=8) (actual time=0.001..0.001 rows=1 loops=332)',)
('              Index Cond: (emp_id = e.supervisor_id)',)
('              Filter: (e.dep_id <> dep_id)',)
('              Rows Removed by Filter: 0',)
('Planning Time: 0.183 ms',)
('JIT:',)
('  Functions: 13',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 0.548 ms, Inlining 0.000 ms, Optimization 0.262 ms, Emission 3.157 ms, Total 3.967 ms',)
('Execution Time: 2316.565 ms',)
('Nested Loop  (cost=0.45..417381.03 rows=3333333 width=46) (actual time=3.666..2202.604 rows=4394737 loops=1)',)
('  ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=23) (actual time=0.003..406.731 rows=10000003 loops=1)',)
('  ->  Memoize  (cost=0.45..0.50 rows=1 width=23) (actual time=0.000..0.000 rows=0 loops=10000003)',)
('        Cache Key: e.salario, e.supervisor_id',)
('        Cache Mode: binary',)
('        Hits: 9999110  Misses: 893  Evictions: 0  Overflows: 0  Memory Usage: 85kB',)
('        ->  Index Scan using unique_emp_id on empregados e1  (cost=0.43..0.49 rows=1 width=23) (actual time=0.001..0.001 rows=0 loops=893)',)
('              Index Cond: (emp_id = e.supervisor_id)',)
('              Filter: (e.salario > salario)',)
('              Rows Removed by Filter: 1',)
('Planning Time: 0.122 ms',)
('JIT:',)
('  Functions: 12',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 0.400 ms, Inlining 0.000 ms, Optimization 0.203 ms, Emission 3.441 ms, Total 4.044 ms',)
('Execution Time: 2276.963 ms',)
('HashAggregate  (cost=1975740.16..1975757.07 rows=1691 width=25) (actual time=6662.403..6662.412 rows=33 loops=1)',)
("  Group Key: d.nome, COALESCE(sum(e.salario) OVER (?), '0'::bigint)",)
('  Batches: 1  Memory Usage: 73kB',)
('  ->  WindowAgg  (cost=1603060.00..1925740.16 rows=10000000 width=25) (actual time=2269.174..5977.859 rows=9697530 loops=1)',)
('        ->  Merge Left Join  (cost=1603060.00..1775740.16 rows=10000000 width=21) (actual time=2269.161..3953.934 rows=9697530 loops=1)',)
('              Merge Cond: (d.dep_id = e.dep_id)',)
('              ->  Sort  (cost=2.16..2.24 rows=33 width=17) (actual time=99.326..99.342 rows=33 loops=1)',)
('                    Sort Key: d.dep_id',)
('                    Sort Method: quicksort  Memory: 27kB',)
('                    ->  Seq Scan on departamentos d  (cost=0.00..1.33 rows=33 width=17) (actual time=99.313..99.318 rows=33 loops=1)',)
('              ->  Materialize  (cost=1603057.83..1653057.83 rows=10000000 width=8) (actual time=2169.804..3358.500 rows=9697530 loops=1)',)
('                    ->  Sort  (cost=1603057.83..1628057.83 rows=10000000 width=8) (actual time=2169.801..2678.737 rows=9697530 loops=1)',)
('                          Sort Key: e.dep_id',)
('                          Sort Method: external merge  Disk: 176216kB',)
('                          ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=8) (actual time=0.007..485.560 rows=10000003 loops=1)',)
('Planning Time: 0.093 ms',)
('JIT:',)
('  Functions: 21',)
('  Options: Inlining true, Optimization true, Expressions true, Deforming true',)
('  Timing: Generation 0.501 ms, Inlining 8.375 ms, Optimization 54.147 ms, Emission 36.832 ms, Total 99.855 ms',)
('Execution Time: 6689.012 ms',)
('WindowAgg  (cost=1671419.83..1846419.83 rows=10000000 width=47) (actual time=2423.439..4324.881 rows=10000003 loops=1)',)
('  ->  Sort  (cost=1671419.83..1696419.83 rows=10000000 width=15) (actual time=2381.934..2855.638 rows=10000003 loops=1)',)
('        Sort Key: dep_id',)
('        Sort Method: external merge  Disk: 266416kB',)
('        ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=15) (actual time=64.728..514.006 rows=10000003 loops=1)',)
('Planning Time: 0.127 ms',)
('JIT:',)
('  Functions: 7',)
('  Options: Inlining true, Optimization true, Expressions true, Deforming true',)
('  Timing: Generation 0.203 ms, Inlining 25.024 ms, Optimization 23.252 ms, Emission 16.467 ms, Total 64.946 ms',)
('Execution Time: 4512.012 ms',)
('Subquery Scan on empregadosalariorank  (cost=1671419.83..1996419.83 rows=50000 width=15) (actual time=3514.762..5628.582 rows=33 loops=1)',)
('  Filter: (empregadosalariorank.salario_rank = 1)',)
('  Rows Removed by Filter: 9999970',)
('  ->  WindowAgg  (cost=1671419.83..1871419.83 rows=10000000 width=23) (actual time=3514.759..5444.908 rows=10000003 loops=1)',)
('        ->  Sort  (cost=1671419.83..1696419.83 rows=10000000 width=15) (actual time=3514.350..4039.822 rows=10000003 loops=1)',)
('              Sort Key: empregados.dep_id, empregados.salario DESC',)
('              Sort Method: external merge  Disk: 252120kB',)
('              ->  Seq Scan on empregados  (cost=0.00..166942.00 rows=10000000 width=15) (actual time=42.462..483.620 rows=10000003 loops=1)',)
('Planning Time: 0.090 ms',)
('JIT:',)
('  Functions: 8',)
('  Options: Inlining true, Optimization true, Expressions true, Deforming true',)
('  Timing: Generation 0.351 ms, Inlining 3.004 ms, Optimization 22.804 ms, Emission 16.665 ms, Total 42.824 ms',)
('Execution Time: 5646.516 ms',)
('Finalize GroupAggregate  (cost=130443.19..130451.55 rows=33 width=8) (actual time=420.745..424.039 rows=33 loops=1)',)
('  Group Key: dep_id',)
('  ->  Gather Merge  (cost=130443.19..130450.89 rows=66 width=8) (actual time=420.734..424.023 rows=99 loops=1)',)
('        Workers Planned: 2',)
('        Workers Launched: 2',)
('        ->  Sort  (cost=129443.16..129443.25 rows=33 width=8) (actual time=411.978..411.980 rows=33 loops=3)',)
('              Sort Key: dep_id',)
('              Sort Method: quicksort  Memory: 26kB',)
('              Worker 0:  Sort Method: quicksort  Memory: 26kB',)
('              Worker 1:  Sort Method: quicksort  Memory: 26kB',)
('              ->  Partial HashAggregate  (cost=129442.00..129442.33 rows=33 width=8) (actual time=411.956..411.959 rows=33 loops=3)',)
('                    Group Key: dep_id',)
('                    Batches: 1  Memory Usage: 24kB',)
('                    Worker 0:  Batches: 1  Memory Usage: 32kB',)
('                    Worker 1:  Batches: 1  Memory Usage: 32kB',)
('                    ->  Parallel Seq Scan on empregados  (cost=0.00..108608.67 rows=4166667 width=8) (actual time=0.014..143.822 rows=3333334 loops=3)',)
('Planning Time: 0.049 ms',)
('JIT:',)
('  Functions: 24',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 0.804 ms, Inlining 0.000 ms, Optimization 0.520 ms, Emission 10.246 ms, Total 11.570 ms',)
('Execution Time: 424.411 ms',)
('HashAggregate  (cost=379443.74..379444.16 rows=11 width=17) (actual time=1972.718..1972.721 rows=1 loops=1)',)
('  Group Key: d.dep_id, d.nome',)
('  Filter: (count(*) < 3)',)
('  Batches: 1  Memory Usage: 24kB',)
('  Rows Removed by Filter: 32',)
('  ->  Hash Right Join  (cost=1.74..304443.74 rows=10000000 width=17) (actual time=4.330..1125.680 rows=9697530 loops=1)',)
('        Hash Cond: (e.dep_id = d.dep_id)',)
('        ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=4) (actual time=0.004..378.010 rows=10000003 loops=1)',)
('        ->  Hash  (cost=1.33..1.33 rows=33 width=17) (actual time=4.321..4.322 rows=33 loops=1)',)
('              Buckets: 1024  Batches: 1  Memory Usage: 10kB',)
('              ->  Seq Scan on departamentos d  (cost=0.00..1.33 rows=33 width=17) (actual time=4.309..4.311 rows=33 loops=1)',)
('Planning Time: 0.130 ms',)
('JIT:',)
('  Functions: 16',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 0.376 ms, Inlining 0.000 ms, Optimization 0.199 ms, Emission 4.132 ms, Total 4.707 ms',)
('Execution Time: 1973.154 ms',)
('Nested Loop  (cost=0.45..417105.08 rows=9696626 width=7) (actual time=3.104..2005.080 rows=9696410 loops=1)',)
('  ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=15) (actual time=0.003..374.471 rows=10000003 loops=1)',)
('  ->  Memoize  (cost=0.45..0.50 rows=1 width=8) (actual time=0.000..0.000 rows=1 loops=10000003)',)
('        Cache Key: e.dep_id, e.supervisor_id',)
('        Cache Mode: binary',)
('        Hits: 9999671  Misses: 332  Evictions: 0  Overflows: 0  Memory Usage: 36kB',)
('        ->  Index Scan using unique_emp_id on empregados e2  (cost=0.43..0.49 rows=1 width=8) (actual time=0.001..0.001 rows=1 loops=332)',)
('              Index Cond: (emp_id = e.supervisor_id)',)
('              Filter: (e.dep_id <> dep_id)',)
('              Rows Removed by Filter: 0',)
('Planning Time: 0.105 ms',)
('JIT:',)
('  Functions: 13',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 0.309 ms, Inlining 0.000 ms, Optimization 0.165 ms, Emission 2.923 ms, Total 3.397 ms',)
('Execution Time: 2157.373 ms',)
('Nested Loop  (cost=0.45..417381.03 rows=3333333 width=46) (actual time=3.888..2003.804 rows=4394737 loops=1)',)
('  ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=23) (actual time=0.003..365.654 rows=10000003 loops=1)',)
('  ->  Memoize  (cost=0.45..0.50 rows=1 width=23) (actual time=0.000..0.000 rows=0 loops=10000003)',)
('        Cache Key: e.salario, e.supervisor_id',)
('        Cache Mode: binary',)
('        Hits: 9999110  Misses: 893  Evictions: 0  Overflows: 0  Memory Usage: 85kB',)
('        ->  Index Scan using unique_emp_id on empregados e1  (cost=0.43..0.49 rows=1 width=23) (actual time=0.001..0.001 rows=0 loops=893)',)
('              Index Cond: (emp_id = e.supervisor_id)',)
('              Filter: (e.salario > salario)',)
('              Rows Removed by Filter: 1',)
('Planning Time: 0.116 ms',)
('JIT:',)
('  Functions: 12',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 0.405 ms, Inlining 0.000 ms, Optimization 0.206 ms, Emission 3.661 ms, Total 4.271 ms',)
('Execution Time: 2071.719 ms',)
('HashAggregate  (cost=1975740.16..1975757.07 rows=1691 width=25) (actual time=5965.194..5965.201 rows=33 loops=1)',)
("  Group Key: d.nome, COALESCE(sum(e.salario) OVER (?), '0'::bigint)",)
('  Batches: 1  Memory Usage: 73kB',)
('  ->  WindowAgg  (cost=1603060.00..1925740.16 rows=10000000 width=25) (actual time=2015.750..5351.986 rows=9697530 loops=1)',)
('        ->  Merge Left Join  (cost=1603060.00..1775740.16 rows=10000000 width=21) (actual time=2015.739..3545.210 rows=9697530 loops=1)',)
('              Merge Cond: (d.dep_id = e.dep_id)',)
('              ->  Sort  (cost=2.16..2.24 rows=33 width=17) (actual time=88.940..88.954 rows=33 loops=1)',)
('                    Sort Key: d.dep_id',)
('                    Sort Method: quicksort  Memory: 27kB',)
('                    ->  Seq Scan on departamentos d  (cost=0.00..1.33 rows=33 width=17) (actual time=88.928..88.933 rows=33 loops=1)',)
('              ->  Materialize  (cost=1603057.83..1653057.83 rows=10000000 width=8) (actual time=1926.771..2993.673 rows=9697530 loops=1)',)
('                    ->  Sort  (cost=1603057.83..1628057.83 rows=10000000 width=8) (actual time=1926.767..2385.725 rows=9697530 loops=1)',)
('                          Sort Key: e.dep_id',)
('                          Sort Method: external merge  Disk: 176216kB',)
('                          ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=8) (actual time=0.007..420.319 rows=10000003 loops=1)',)
('Planning Time: 0.087 ms',)
('JIT:',)
('  Functions: 21',)
('  Options: Inlining true, Optimization true, Expressions true, Deforming true',)
('  Timing: Generation 0.491 ms, Inlining 4.811 ms, Optimization 49.948 ms, Emission 34.234 ms, Total 89.483 ms',)
('Execution Time: 5991.143 ms',)
('Hash Join  (cost=130452.37..325273.16 rows=3333333 width=11) (actual time=411.776..2252.940 rows=4944783 loops=1)',)
('  Hash Cond: (e.dep_id = e_1.dep_id)',)
('  Join Filter: ((e.salario)::numeric > (avg(e_1.salario)))',)
('  Rows Removed by Join Filter: 5055220',)
('  ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=15) (actual time=0.004..381.184 rows=10000003 loops=1)',)
('  ->  Hash  (cost=130451.96..130451.96 rows=33 width=36) (actual time=411.763..411.821 rows=33 loops=1)',)
('        Buckets: 1024  Batches: 1  Memory Usage: 10kB',)
('        ->  Finalize GroupAggregate  (cost=130443.19..130451.63 rows=33 width=36) (actual time=411.720..411.813 rows=33 loops=1)',)
('              Group Key: e_1.dep_id',)
('              ->  Gather Merge  (cost=130443.19..130450.89 rows=66 width=36) (actual time=411.692..411.765 rows=99 loops=1)',)
('                    Workers Planned: 2',)
('                    Workers Launched: 2',)
('                    ->  Sort  (cost=129443.16..129443.25 rows=33 width=36) (actual time=402.833..402.836 rows=33 loops=3)',)
('                          Sort Key: e_1.dep_id',)
('                          Sort Method: quicksort  Memory: 27kB',)
('                          Worker 0:  Sort Method: quicksort  Memory: 27kB',)
('                          Worker 1:  Sort Method: quicksort  Memory: 27kB',)
('                          ->  Partial HashAggregate  (cost=129442.00..129442.33 rows=33 width=36) (actual time=402.807..402.811 rows=33 loops=3)',)
('                                Group Key: e_1.dep_id',)
('                                Batches: 1  Memory Usage: 24kB',)
('                                Worker 0:  Batches: 1  Memory Usage: 32kB',)
('                                Worker 1:  Batches: 1  Memory Usage: 32kB',)
('                                ->  Parallel Seq Scan on empregados e_1  (cost=0.00..108608.67 rows=4166667 width=8) (actual time=0.013..134.683 rows=3333334 loops=3)',)
('Planning Time: 0.286 ms',)
('JIT:',)
('  Functions: 35',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 0.991 ms, Inlining 0.000 ms, Optimization 0.627 ms, Emission 14.301 ms, Total 15.920 ms',)
('Execution Time: 2336.007 ms',)
('Subquery Scan on d  (cost=379443.74..379444.40 rows=33 width=21) (actual time=2977.484..2977.491 rows=33 loops=1)',)
('  ->  HashAggregate  (cost=379443.74..379444.07 rows=33 width=25) (actual time=2977.481..2977.486 rows=33 loops=1)',)
('        Group Key: d_1.dep_id, d_1.nome',)
('        Batches: 1  Memory Usage: 24kB',)
('        ->  Hash Right Join  (cost=1.74..304443.74 rows=10000000 width=64) (actual time=4.400..2089.399 rows=9697530 loops=1)',)
('              Hash Cond: (e.dep_id = d_1.dep_id)',)
('              ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=51) (actual time=0.014..1343.119 rows=10000003 loops=1)',)
('              ->  Hash  (cost=1.33..1.33 rows=33 width=17) (actual time=4.380..4.381 rows=33 loops=1)',)
('                    Buckets: 1024  Batches: 1  Memory Usage: 10kB',)
('                    ->  Seq Scan on departamentos d_1  (cost=0.00..1.33 rows=33 width=17) (actual time=0.003..0.006 rows=33 loops=1)',)
('Planning Time: 0.096 ms',)
('JIT:',)
('  Functions: 15',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 0.467 ms, Inlining 0.000 ms, Optimization 0.259 ms, Emission 4.132 ms, Total 4.858 ms',)
('Execution Time: 2978.025 ms',)
('Hash Join  (cost=130452.37..325273.16 rows=3333333 width=47) (actual time=414.601..2209.432 rows=4944783 loops=1)',)
('  Hash Cond: (e.dep_id = avg.dep_id)',)
('  Join Filter: ((e.salario)::numeric >= avg.avg_salario)',)
('  Rows Removed by Join Filter: 5055220',)
('  ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=15) (actual time=0.003..370.064 rows=10000003 loops=1)',)
('  ->  Hash  (cost=130451.96..130451.96 rows=33 width=36) (actual time=414.588..414.649 rows=33 loops=1)',)
('        Buckets: 1024  Batches: 1  Memory Usage: 10kB',)
('        ->  Subquery Scan on avg  (cost=130443.19..130451.96 rows=33 width=36) (actual time=414.540..414.641 rows=33 loops=1)',)
('              ->  Finalize GroupAggregate  (cost=130443.19..130451.63 rows=33 width=36) (actual time=414.538..414.637 rows=33 loops=1)',)
('                    Group Key: e_1.dep_id',)
('                    ->  Gather Merge  (cost=130443.19..130450.89 rows=66 width=36) (actual time=414.513..414.587 rows=99 loops=1)',)
('                          Workers Planned: 2',)
('                          Workers Launched: 2',)
('                          ->  Sort  (cost=129443.16..129443.25 rows=33 width=36) (actual time=405.860..405.862 rows=33 loops=3)',)
('                                Sort Key: e_1.dep_id',)
('                                Sort Method: quicksort  Memory: 27kB',)
('                                Worker 0:  Sort Method: quicksort  Memory: 27kB',)
('                                Worker 1:  Sort Method: quicksort  Memory: 27kB',)
('                                ->  Partial HashAggregate  (cost=129442.00..129442.33 rows=33 width=36) (actual time=405.833..405.836 rows=33 loops=3)',)
('                                      Group Key: e_1.dep_id',)
('                                      Batches: 1  Memory Usage: 24kB',)
('                                      Worker 0:  Batches: 1  Memory Usage: 32kB',)
('                                      Worker 1:  Batches: 1  Memory Usage: 32kB',)
('                                      ->  Parallel Seq Scan on empregados e_1  (cost=0.00..108608.67 rows=4166667 width=8) (actual time=0.014..136.470 rows=3333334 loops=3)',)
('Planning Time: 0.102 ms',)
('JIT:',)
('  Functions: 37',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 1.002 ms, Inlining 0.000 ms, Optimization 0.670 ms, Emission 13.842 ms, Total 15.514 ms',)
('Execution Time: 2291.243 ms',)
('WindowAgg  (cost=1671419.83..1846419.83 rows=10000000 width=47) (actual time=2406.716..4262.529 rows=10000003 loops=1)',)
('  ->  Sort  (cost=1671419.83..1696419.83 rows=10000000 width=15) (actual time=2365.375..2824.097 rows=10000003 loops=1)',)
('        Sort Key: dep_id',)
('        Sort Method: external merge  Disk: 266416kB',)
('        ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=15) (actual time=65.056..505.964 rows=10000003 loops=1)',)
('Planning Time: 0.123 ms',)
('JIT:',)
('  Functions: 7',)
('  Options: Inlining true, Optimization true, Expressions true, Deforming true',)
('  Timing: Generation 0.202 ms, Inlining 25.099 ms, Optimization 22.988 ms, Emission 16.982 ms, Total 65.271 ms',)
('Execution Time: 4447.364 ms',)
('Subquery Scan on empregadosalariorank  (cost=1671419.83..1996419.83 rows=50000 width=15) (actual time=3589.301..5660.674 rows=33 loops=1)',)
('  Filter: (empregadosalariorank.salario_rank = 1)',)
('  Rows Removed by Filter: 9999970',)
('  ->  WindowAgg  (cost=1671419.83..1871419.83 rows=10000000 width=23) (actual time=3589.297..5480.955 rows=10000003 loops=1)',)
('        ->  Sort  (cost=1671419.83..1696419.83 rows=10000000 width=15) (actual time=3588.882..4104.321 rows=10000003 loops=1)',)
('              Sort Key: empregados.dep_id, empregados.salario DESC',)
('              Sort Method: external merge  Disk: 252120kB',)
('              ->  Seq Scan on empregados  (cost=0.00..166942.00 rows=10000000 width=15) (actual time=41.781..485.115 rows=10000003 loops=1)',)
('Planning Time: 0.077 ms',)
('JIT:',)
('  Functions: 8',)
('  Options: Inlining true, Optimization true, Expressions true, Deforming true',)
('  Timing: Generation 0.332 ms, Inlining 2.565 ms, Optimization 22.796 ms, Emission 16.432 ms, Total 42.125 ms',)
('Execution Time: 5680.271 ms',)
('Finalize GroupAggregate  (cost=130443.19..130451.55 rows=33 width=8) (actual time=411.312..414.448 rows=33 loops=1)',)
('  Group Key: dep_id',)
('  ->  Gather Merge  (cost=130443.19..130450.89 rows=66 width=8) (actual time=411.304..414.434 rows=99 loops=1)',)
('        Workers Planned: 2',)
('        Workers Launched: 2',)
('        ->  Sort  (cost=129443.16..129443.25 rows=33 width=8) (actual time=401.322..401.323 rows=33 loops=3)',)
('              Sort Key: dep_id',)
('              Sort Method: quicksort  Memory: 26kB',)
('              Worker 0:  Sort Method: quicksort  Memory: 26kB',)
('              Worker 1:  Sort Method: quicksort  Memory: 26kB',)
('              ->  Partial HashAggregate  (cost=129442.00..129442.33 rows=33 width=8) (actual time=401.280..401.283 rows=33 loops=3)',)
('                    Group Key: dep_id',)
('                    Batches: 1  Memory Usage: 24kB',)
('                    Worker 0:  Batches: 1  Memory Usage: 32kB',)
('                    Worker 1:  Batches: 1  Memory Usage: 32kB',)
('                    ->  Parallel Seq Scan on empregados  (cost=0.00..108608.67 rows=4166667 width=8) (actual time=0.017..138.265 rows=3333334 loops=3)',)
('Planning Time: 0.048 ms',)
('JIT:',)
('  Functions: 24',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 0.861 ms, Inlining 0.000 ms, Optimization 0.598 ms, Emission 10.712 ms, Total 12.172 ms',)
('Execution Time: 414.866 ms',)
('HashAggregate  (cost=379443.74..379444.16 rows=11 width=17) (actual time=1988.524..1988.527 rows=1 loops=1)',)
('  Group Key: d.dep_id, d.nome',)
('  Filter: (count(*) < 3)',)
('  Batches: 1  Memory Usage: 24kB',)
('  Rows Removed by Filter: 32',)
('  ->  Hash Right Join  (cost=1.74..304443.74 rows=10000000 width=17) (actual time=3.971..1136.095 rows=9697530 loops=1)',)
('        Hash Cond: (e.dep_id = d.dep_id)',)
('        ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=4) (actual time=0.003..380.483 rows=10000003 loops=1)',)
('        ->  Hash  (cost=1.33..1.33 rows=33 width=17) (actual time=3.962..3.963 rows=33 loops=1)',)
('              Buckets: 1024  Batches: 1  Memory Usage: 10kB',)
('              ->  Seq Scan on departamentos d  (cost=0.00..1.33 rows=33 width=17) (actual time=3.951..3.953 rows=33 loops=1)',)
('Planning Time: 0.118 ms',)
('JIT:',)
('  Functions: 16',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 0.357 ms, Inlining 0.000 ms, Optimization 0.183 ms, Emission 3.786 ms, Total 4.326 ms',)
('Execution Time: 1988.936 ms',)
('Nested Loop  (cost=0.45..417105.08 rows=9696626 width=7) (actual time=3.253..2007.613 rows=9696410 loops=1)',)
('  ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=15) (actual time=0.003..374.339 rows=10000003 loops=1)',)
('  ->  Memoize  (cost=0.45..0.50 rows=1 width=8) (actual time=0.000..0.000 rows=1 loops=10000003)',)
('        Cache Key: e.dep_id, e.supervisor_id',)
('        Cache Mode: binary',)
('        Hits: 9999671  Misses: 332  Evictions: 0  Overflows: 0  Memory Usage: 36kB',)
('        ->  Index Scan using unique_emp_id on empregados e2  (cost=0.43..0.49 rows=1 width=8) (actual time=0.001..0.001 rows=1 loops=332)',)
('              Index Cond: (emp_id = e.supervisor_id)',)
('              Filter: (e.dep_id <> dep_id)',)
('              Rows Removed by Filter: 0',)
('Planning Time: 0.147 ms',)
('JIT:',)
('  Functions: 13',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 0.379 ms, Inlining 0.000 ms, Optimization 0.177 ms, Emission 3.058 ms, Total 3.614 ms',)
('Execution Time: 2160.172 ms',)
('Nested Loop  (cost=0.45..417381.03 rows=3333333 width=46) (actual time=3.569..2087.116 rows=4394737 loops=1)',)
('  ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=23) (actual time=0.003..382.964 rows=10000003 loops=1)',)
('  ->  Memoize  (cost=0.45..0.50 rows=1 width=23) (actual time=0.000..0.000 rows=0 loops=10000003)',)
('        Cache Key: e.salario, e.supervisor_id',)
('        Cache Mode: binary',)
('        Hits: 9999110  Misses: 893  Evictions: 0  Overflows: 0  Memory Usage: 85kB',)
('        ->  Index Scan using unique_emp_id on empregados e1  (cost=0.43..0.49 rows=1 width=23) (actual time=0.001..0.001 rows=0 loops=893)',)
('              Index Cond: (emp_id = e.supervisor_id)',)
('              Filter: (e.salario > salario)',)
('              Rows Removed by Filter: 1',)
('Planning Time: 0.118 ms',)
('JIT:',)
('  Functions: 12',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 0.571 ms, Inlining 0.000 ms, Optimization 0.254 ms, Emission 3.293 ms, Total 4.118 ms',)
('Execution Time: 2157.939 ms',)
('HashAggregate  (cost=1975740.16..1975757.07 rows=1691 width=25) (actual time=6068.975..6068.982 rows=33 loops=1)',)
("  Group Key: d.nome, COALESCE(sum(e.salario) OVER (?), '0'::bigint)",)
('  Batches: 1  Memory Usage: 73kB',)
('  ->  WindowAgg  (cost=1603060.00..1925740.16 rows=10000000 width=25) (actual time=2025.572..5445.569 rows=9697530 loops=1)',)
('        ->  Merge Left Join  (cost=1603060.00..1775740.16 rows=10000000 width=21) (actual time=2025.561..3580.993 rows=9697530 loops=1)',)
('              Merge Cond: (d.dep_id = e.dep_id)',)
('              ->  Sort  (cost=2.16..2.24 rows=33 width=17) (actual time=91.257..91.271 rows=33 loops=1)',)
('                    Sort Key: d.dep_id',)
('                    Sort Method: quicksort  Memory: 27kB',)
('                    ->  Seq Scan on departamentos d  (cost=0.00..1.33 rows=33 width=17) (actual time=91.245..91.249 rows=33 loops=1)',)
('              ->  Materialize  (cost=1603057.83..1653057.83 rows=10000000 width=8) (actual time=1934.275..3020.828 rows=9697530 loops=1)',)
('                    ->  Sort  (cost=1603057.83..1628057.83 rows=10000000 width=8) (actual time=1934.270..2401.101 rows=9697530 loops=1)',)
('                          Sort Key: e.dep_id',)
('                          Sort Method: external merge  Disk: 176216kB',)
('                          ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=8) (actual time=0.008..419.989 rows=10000003 loops=1)',)
('Planning Time: 0.085 ms',)
('JIT:',)
('  Functions: 21',)
('  Options: Inlining true, Optimization true, Expressions true, Deforming true',)
('  Timing: Generation 0.425 ms, Inlining 4.818 ms, Optimization 49.962 ms, Emission 36.517 ms, Total 91.722 ms',)
('Execution Time: 6095.857 ms',)
('Hash Join  (cost=130452.37..325273.16 rows=3333333 width=11) (actual time=446.612..2229.474 rows=4944783 loops=1)',)
('  Hash Cond: (e.dep_id = e_1.dep_id)',)
('  Join Filter: ((e.salario)::numeric > (avg(e_1.salario)))',)
('  Rows Removed by Join Filter: 5055220',)
('  ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=15) (actual time=0.004..365.329 rows=10000003 loops=1)',)
('  ->  Hash  (cost=130451.96..130451.96 rows=33 width=36) (actual time=446.597..446.648 rows=33 loops=1)',)
('        Buckets: 1024  Batches: 1  Memory Usage: 10kB',)
('        ->  Finalize GroupAggregate  (cost=130443.19..130451.63 rows=33 width=36) (actual time=446.549..446.635 rows=33 loops=1)',)
('              Group Key: e_1.dep_id',)
('              ->  Gather Merge  (cost=130443.19..130450.89 rows=66 width=36) (actual time=446.522..446.586 rows=99 loops=1)',)
('                    Workers Planned: 2',)
('                    Workers Launched: 2',)
('                    ->  Sort  (cost=129443.16..129443.25 rows=33 width=36) (actual time=437.951..437.953 rows=33 loops=3)',)
('                          Sort Key: e_1.dep_id',)
('                          Sort Method: quicksort  Memory: 27kB',)
('                          Worker 0:  Sort Method: quicksort  Memory: 27kB',)
('                          Worker 1:  Sort Method: quicksort  Memory: 27kB',)
('                          ->  Partial HashAggregate  (cost=129442.00..129442.33 rows=33 width=36) (actual time=437.925..437.928 rows=33 loops=3)',)
('                                Group Key: e_1.dep_id',)
('                                Batches: 1  Memory Usage: 24kB',)
('                                Worker 0:  Batches: 1  Memory Usage: 32kB',)
('                                Worker 1:  Batches: 1  Memory Usage: 32kB',)
('                                ->  Parallel Seq Scan on empregados e_1  (cost=0.00..108608.67 rows=4166667 width=8) (actual time=0.013..148.268 rows=3333334 loops=3)',)
('Planning Time: 0.148 ms',)
('JIT:',)
('  Functions: 35',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 1.175 ms, Inlining 0.000 ms, Optimization 0.646 ms, Emission 13.486 ms, Total 15.306 ms',)
('Execution Time: 2310.087 ms',)
('Subquery Scan on d  (cost=379443.74..379444.40 rows=33 width=21) (actual time=3189.720..3189.726 rows=33 loops=1)',)
('  ->  HashAggregate  (cost=379443.74..379444.07 rows=33 width=25) (actual time=3189.718..3189.722 rows=33 loops=1)',)
('        Group Key: d_1.dep_id, d_1.nome',)
('        Batches: 1  Memory Usage: 24kB',)
('        ->  Hash Right Join  (cost=1.74..304443.74 rows=10000000 width=64) (actual time=3.575..2237.942 rows=9697530 loops=1)',)
('              Hash Cond: (e.dep_id = d_1.dep_id)',)
('              ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=51) (actual time=0.009..1441.033 rows=10000003 loops=1)',)
('              ->  Hash  (cost=1.33..1.33 rows=33 width=17) (actual time=3.561..3.562 rows=33 loops=1)',)
('                    Buckets: 1024  Batches: 1  Memory Usage: 10kB',)
('                    ->  Seq Scan on departamentos d_1  (cost=0.00..1.33 rows=33 width=17) (actual time=0.002..0.004 rows=33 loops=1)',)
('Planning Time: 0.116 ms',)
('JIT:',)
('  Functions: 15',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 0.364 ms, Inlining 0.000 ms, Optimization 0.182 ms, Emission 3.389 ms, Total 3.935 ms',)
('Execution Time: 3190.167 ms',)
('Hash Join  (cost=130452.37..325273.16 rows=3333333 width=47) (actual time=479.116..2492.549 rows=4944783 loops=1)',)
('  Hash Cond: (e.dep_id = avg.dep_id)',)
('  Join Filter: ((e.salario)::numeric >= avg.avg_salario)',)
('  Rows Removed by Join Filter: 5055220',)
('  ->  Seq Scan on empregados e  (cost=0.00..166942.00 rows=10000000 width=15) (actual time=0.003..418.464 rows=10000003 loops=1)',)
('  ->  Hash  (cost=130451.96..130451.96 rows=33 width=36) (actual time=479.088..479.148 rows=33 loops=1)',)
('        Buckets: 1024  Batches: 1  Memory Usage: 10kB',)
('        ->  Subquery Scan on avg  (cost=130443.19..130451.96 rows=33 width=36) (actual time=478.987..479.123 rows=33 loops=1)',)
('              ->  Finalize GroupAggregate  (cost=130443.19..130451.63 rows=33 width=36) (actual time=478.981..479.113 rows=33 loops=1)',)
('                    Group Key: e_1.dep_id',)
('                    ->  Gather Merge  (cost=130443.19..130450.89 rows=66 width=36) (actual time=478.914..479.014 rows=99 loops=1)',)
('                          Workers Planned: 2',)
('                          Workers Launched: 2',)
('                          ->  Sort  (cost=129443.16..129443.25 rows=33 width=36) (actual time=470.164..470.168 rows=33 loops=3)',)
('                                Sort Key: e_1.dep_id',)
('                                Sort Method: quicksort  Memory: 27kB',)
('                                Worker 0:  Sort Method: quicksort  Memory: 27kB',)
('                                Worker 1:  Sort Method: quicksort  Memory: 27kB',)
('                                ->  Partial HashAggregate  (cost=129442.00..129442.33 rows=33 width=36) (actual time=470.127..470.134 rows=33 loops=3)',)
('                                      Group Key: e_1.dep_id',)
('                                      Batches: 1  Memory Usage: 24kB',)
('                                      Worker 0:  Batches: 1  Memory Usage: 32kB',)
('                                      Worker 1:  Batches: 1  Memory Usage: 32kB',)
('                                      ->  Parallel Seq Scan on empregados e_1  (cost=0.00..108608.67 rows=4166667 width=8) (actual time=0.014..159.268 rows=3333334 loops=3)',)
('Planning Time: 0.088 ms',)
('JIT:',)
('  Functions: 37',)
('  Options: Inlining false, Optimization false, Expressions true, Deforming true',)
('  Timing: Generation 1.017 ms, Inlining 0.000 ms, Optimization 0.659 ms, Emission 14.013 ms, Total 15.690 ms',)
('Execution Time: 2584.231 ms',)
